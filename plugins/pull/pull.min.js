"use strict";!function(a,b,c){function d(a){var b={extend:function(a,c){for(var d=Object.keys(c),e=d.length;e--;)"object"==typeof c[d[e]]?b.extend(a[d[e]],c[d[e]]):a[d[e]]=c[d[e]];return a}};if(a=a||{},this.defaults={scroll:"appScroll",limit:50,up:{auto:!1,isOpen:!1,pullInitName:"上拉可以刷新",pullStartName:"释放立即刷新",pullLoadingName:"正在刷新...",pullClearName:"没有更多数据了",callback:function(){}},down:{auto:!1,isOpen:!1,pullInitName:"下拉可以刷新",pullStartName:"释放立即刷新",pullLoadingName:"正在刷新...",pullClearName:"没有更多数据了",callback:function(){}}},this.defaults=b.extend(this.defaults,a),this.pullUpState=0,this.pullDownState=0,!c.iscrollList[this.defaults.scroll])throw Error("Iscroll实例对象不存在");this.pull=c.iscrollList[this.defaults.scroll],this._init()}d.prototype._init=function(){this._pullElement(),this._bindEvent()},d.prototype.endPullToRefresh=function(a){a&&this["down"==this.defaults.pullState?"_pullDownState":"_pullUpState"](3),this.pull.refresh()},d.prototype.resetPullToRefresh=function(a){a=a||this.defaults.pullState,this["down"==a?"_pullDownState":"_pullUpState"](0)},d.prototype._pullElement=function(){this.defaults.up.isOpen&&(this.pullUp=this.pull.wrapper.querySelector(".ue-pull-up"),this.pullUp?(this.pullUpIcon=this.pullUp.querySelector(".ue-pull-up-icon"),this.pullUpLabel=this.pullUp.querySelector(".ue-pull-up-label")):this._createPullUp()),this.defaults.down.isOpen&&(this.pullDown=this.pull.wrapper.querySelector(".ue-pull-down"),this.pullDown?(this.pullDownIcon=this.pullDown.querySelector(".ue-pull-down-icon"),this.pullDownLabel=this.pullDown.querySelector(".ue-pull-down-label")):this._createPullDown())},d.prototype._createPullUp=function(){this.pullUp=b.createElement("div"),this.pullUpIcon=b.createElement("span"),this.pullUpLabel=b.createElement("span"),this.pullUp.className="ue-pull-up",this.pullUpIcon.className="ue-pull-up-icon",this.pullUpLabel.className="ue-pull-up-label",this.pullUp.appendChild(this.pullUpIcon),this.pullUp.appendChild(this.pullUpLabel),this.pull.wrapper.appendChild(this.pullUp)},d.prototype._createPullDown=function(){this.pullDown=b.createElement("div"),this.pullDownIcon=b.createElement("span"),this.pullDownLabel=b.createElement("span"),this.pullDown.className="ue-pull-down",this.pullDownIcon.className="ue-pull-down-icon",this.pullDownLabel.className="ue-pull-down-label",this.pullDown.appendChild(this.pullDownIcon),this.pullDown.appendChild(this.pullDownLabel),this.pull.wrapper.insertBefore(this.pullDown,this.pull.wrapper.children[0])},d.prototype._bindEvent=function(){var a=this,b=null;a.defaults.up.auto&&(a._pullUpState(2),a.defaults.up.callback(),a.defaults.up.auto=!1),a.defaults.down.auto&&(a._pullDownState(2),a.defaults.down.callback(),a.defaults.down.auto=!1),this.pull.on("scrollEnd",function(){}),this.pull.on("refresh",function(){a.pull.pullInitState?(clearInterval(b),3!=a.pullDownState&&a.defaults.down.isOpen&&a._pullDownState(0),3!=a.pullUpState&&a.defaults.up.isOpen&&a._pullUpState(0)):a.pull.pullInitState=!0}),this.pull.on("scroll",function(){if(this.y>0&&a.defaults.down.isOpen){if(2==a.pullDownState||3==a.pullDownState)return!1;a._pullDownState(this.y>a.defaults.limit?1:0)}if(this.maxScrollY>this.y&&a.defaults.up.isOpen){if(2==a.pullUpState||3==a.pullUpState)return!1;a._pullUpState(this.maxScrollY-a.defaults.limit>this.y?1:0)}}),this.pull.scroller.addEventListener("touchend",function(){a.pull.y>a.defaults.limit&&a.defaults.down.isOpen&&(a.defaults.pullState="down",1==a.pullDownState&&(a._pullDownState(2),a.defaults.down.callback())),a.pull.maxScrollY>a.pull.y&&a.defaults.up.isOpen&&(a.defaults.pullState="up",1==a.pullUpState&&(a._pullUpState(2),a.defaults.up.callback()))},!1)},d.prototype._pullDownState=function(a){switch(a){case 0:this.pullDownState=0,this.pull.scroller.style.top="0px",this.pullDownIcon.style.display="inline-block",this.pullDownLabel.innerText=this.defaults.down.pullInitName,this.pullDownIcon.className="ue-pull-down-icon ue-icon ue-icon-pulldown";break;case 1:this.pullDownState=1,this.pull.scroller.style.top="0px",this.pullDownIcon.style.display="inline-block",this.pullDownLabel.innerText=this.defaults.down.pullStartName,this.pullDownIcon.className="ue-pull-down-icon ue-icon ue-icon-pulldown ue-rotate-180";break;case 2:this.pullDownState=2,this.pull.scroller.style.top=this.defaults.limit+"px",this.pullDownIcon.style.display="inline-block",this.pullDownLabel.innerText=this.defaults.down.pullLoadingName,this.pullDownIcon.className="ue-pull-down-icon ue-spinner";break;case 3:this.pullDownState=3,this.pull.scroller.style.top="0px",this.pullDownIcon.style.display="none",this.pullDownLabel.innerText=this.defaults.down.pullClearName}},d.prototype._pullUpState=function(a){switch(a){case 0:this.pullUpState=0,this.pull.scroller.style.top="0px",this.pullUpIcon.style.display="inline-block",this.pullUpLabel.innerText=this.defaults.up.pullInitName,this.pullUpIcon.className="ue-pull-up-icon ue-icon ue-icon-pulldown ue-rotate-180";break;case 1:this.pullUpState=1,this.pull.scroller.style.top="0px",this.pullUpIcon.style.display="inline-block",this.pullUpLabel.innerText=this.defaults.up.pullStartName,this.pullUpIcon.className="ue-pull-up-icon ue-icon ue-icon-pulldown";break;case 2:this.pullUpState=2,this.pull.scroller.style.top=-this.defaults.limit+"px",this.pullUpIcon.style.display="inline-block",this.pullUpLabel.innerText=this.defaults.up.pullLoadingName,this.pullUpIcon.className="ue-pull-up-icon ue-spinner";break;case 3:this.pullUpState=3,this.pull.scroller.style.top="0px",this.pullUpIcon.style.display="none",this.pullUpLabel.innerText=this.defaults.up.pullClearName}},"object"==typeof exports?module.exports=d:"function"==typeof define&&define.amd?define([],function(){return d}):a.Pull=d}(window,document,ue);