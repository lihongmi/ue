"use strict";!function(a,b){var c="ontouchstart"in a,d={extend:function(a,b){for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a},each:function(a,b){var c,d;if(a)if(c=0,a.length)for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},tf:function(a){return a="string"==typeof a?parseInt(a):a,(10>a?"0":"")+a},formatDate:function(a,b){a="string"==typeof a?new Date(a):a;var c=d.tf(a.getFullYear()),e=d.tf(a.getMonth()+1),f=d.tf(a.getDate()),g=d.tf(a.getDay());return{getFullYear:parseInt(c),getMonth:parseInt(e),getDate:parseInt(f),getDay:parseInt(g),date:b.replace(/yyyy|MM|dd/g,function(a){switch(a){case"yyyy":return c;case"MM":return e;case"dd":return f}})}},getStringDate:function(a){if("string"==typeof a){for(var b=a.split("-"),c=0;c<b.length;c++)b[c]=d.tf(b[c]);return b.join("")}},event:{START:c?"touchstart":"mousedown",MOVE:c?"touchmove":"mousemove",END:c?"touchend":"mouseup"}},e='<div class="ue-calendar-title ue-clearfix">{{ date }}</div><div class="ue-calendar-nav">{{ nav }}</div><div class="ue-calendar-wrap ue-clearfix">{{ time }}</div>',f={"1-1":"元旦","1-15":"元宵节","3-8":"妇女节","3-12":"植树节","4-5":"清明节","5-1":"劳动节","5-4":"青年节","5-5":"端午节","6-1":"儿童节","7-1":"建党节","8-1":"建军节","8-15":"中秋节","9-9":"重阳节","9-10":"教师节","9-15":"中秋节","10-1":"国庆节","11-25":"感恩节","12-8":"腊八节"},g=function(a){a=a||{},this.defaults={value:null,minDate:null,maxDate:null,isPopup:!1,inputReadOnly:!0,selectNav:["周一","周二","周三","周四","周五","周六","周日"],dateFormat:"yyyy-MM-dd",onChange:function(){}},this.defaults=d.extend(this.defaults,a),this._init()};g.prototype={constroctor:g,_init:function(){this.calendar="string"==typeof this.defaults.el?b.querySelector(this.defaults.el):this.defaults.el,this.calendar.className="ue-calendar",this.defaults.isPopup&&(this.calendar.classList.add("ue-calendar-popup"),this.input="string"==typeof this.defaults.input?b.querySelector(this.defaults.input):this.defaults.input,this.input[this.defaults.inputReadOnly?"setAttribute":"removeAttribute"]("readonly",!0),this.defaults.value=""==this.input.value?this.defaults.value:this.input.value),this._selectorElement(),this.defaults.isPopup&&this._close()},_open:function(){this.calendar.style.opacity=1,this.calendar.style.webkitTransition="all ease-in-out 0.5s",this.calendar.style.transition="all ease-in-out 0.5s",this.calendar.style.webkitTransform="translate3d(0, 0, 0)",this.calendar.style.transform="translate3d(0, 0, 0)"},_close:function(){var a=this.calendar.offsetHeight;this.calendar.style.opacity=0,this.calendar.style.webkitTransform="translate3d(0, "+a+"px, 0)",this.calendar.style.transform="translate3d(0, "+a+"px, 0)"},_updateDate:function(a,b){return b?d.formatDate(a?new Date(a):new Date,this.defaults.dateFormat):(this.date=d.formatDate(a?new Date(a):new Date,this.defaults.dateFormat),void 0)},_selectorElement:function(){this._updateDate(this.defaults.value),this.localDate=this.date,this._render()},_render:function(){this.calendar.innerHTML=e.replace("{{ date }}",this._createCalendarTitle()).replace("{{ nav }}",this._createCalendarNav()).replace("{{ time }}",this._createCalendarWrap()),this._bindEvent()},_bindEvent:function(){var a=this;this.grids=this.calendar.querySelectorAll("[data-current]"),this.calendarLeft=this.calendar.querySelector(".ue-calendar-left"),this.calendarRight=this.calendar.querySelector(".ue-calendar-right"),d.each(this.grids,function(b,c){c.addEventListener(d.event.START,function(){for(var b=0;b<a.grids.length;b++)a.grids[b].classList.remove("ue-active");this.classList.add("ue-active"),a.defaults.onChange.call(a,c,c.dataset.current),a.defaults.isPopup&&(a._close(),a._triggerShade(),a.input.value=c.dataset.current)},!1)}),this.calendar.addEventListener(d.event.MOVE,function(a){a.preventDefault()},!1),this.calendarLeft.addEventListener(d.event.START,function(){this._prevDate()}.bind(this),!1),this.calendarRight.addEventListener(d.event.START,function(){this._nextDate()}.bind(this),!1),this.defaults.isPopup&&this.input.addEventListener(d.event.START,function(){this._open(),this._triggerShade()}.bind(this),!1)},_nextDate:function(){this._getNextMonthDate(++this.date.getMonth)},_prevDate:function(){this._getNextMonthDate(--this.date.getMonth)},_getNextMonthDate:function(a){(a>12||1>a)&&(this.date.getFullYear=this.date.getFullYear+Math.floor((this.date.getMonth-1)/12),this.date.getMonth=0==this.date.getMonth%12?12:this.date.getMonth%12),this._render()},_createCalendarTitle:function(){return'<a href="javascript:;" class="ue-calendar-left ue-icon ue-icon-back"></a><a href="javascript:;" class="ue-calendar-right ue-icon ue-icon-forward"></a><h2 class="ue-calendar-headline">'+this.date.getFullYear+"年"+d.tf(this.date.getMonth)+"月</h2>"},_createCalendarNav:function(){var a="";return this.defaults.selectNav.forEach(function(b,c){a+='<div class="ue-calendar-nav-name'+(c>4?" ue-calendar-cl-orange":" ")+'">'+b+"</div>"}),a},_createCalendarWrap:function(){var e,g,h,i,j,k,l,m,n,o,p,q,a=[],b=[],c=Math.abs(new Date(this.date.getFullYear,this.date.getMonth-1,1).getDay());for(c=0==c?7:c,e=new Date(this.date.getFullYear,this.date.getMonth-1,0).getDate(),g=new Date(this.date.getFullYear,this.date.getMonth,0).getDate(),h=e,i=c-2,j=0,k=0,l=42-c-g+1;h>0;h--)b.push(h);for(;i>=0;i--)a.push('<a href="javascript:;" class="ue-calendar-grid ue-calendar-cl-cfcfcf"><span>'+b[i]+"</span><span>入住</span></a>");for(;g>j;j++)m=this._updateDate(this.date.getFullYear+"-"+this.date.getMonth+"-"+(j+1),!0),n=f[m.getMonth+"-"+m.getDate],o=n?n:"",p="ue-calendar-grid",p+=n?" ue-mini ue-calendar-cl-03C7AD":"",p+=6==m.getDay||0==m.getDay?" ue-calendar-cl-orange":"",p+=this.localDate.date==m.date?" ue-active":"",q=this.defaults.minDate&&d.getStringDate(this.defaults.minDate)>d.getStringDate(m.date)||this.defaults.maxDate&&d.getStringDate(this.defaults.maxDate)<d.getStringDate(m.date),p+=q?" ue-calendar-cl-cfcfcf":"",a.push('<a href="javascript:;" class="'+p+'"  '+(q?"":"data-current="+m.date)+'  data-index="'+j+'"><span>'+(j+1)+"</span><span>"+o+"</span></a>");for(;l>k;k++)a.push('<a href="javascript:;" class="ue-calendar-grid ue-calendar-cl-cfcfcf"><span>'+(k+1)+"</span><span>入住</span></a>");return a.join("")},_triggerShade:function(){this.ueShade=b.querySelector(".ue-calendar-shade"),this.ueShade?b.body.removeChild(this.ueShade):(this.ueShade=b.createElement("div"),this.ueShade.className="ue-calendar-shade",this.ueShade.addEventListener(d.event.START,function(){this._close(),this._triggerShade()}.bind(this),!1),b.body.appendChild(this.ueShade))}},"object"==typeof exports?module.exports=g:"function"==typeof define&&define.amd?define([],function(){return g}):a.Calendar=g}(window,document);